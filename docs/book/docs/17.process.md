
        <h2 id="t01. &#x8FDB;&#x7A0B;">1. &#x8FDB;&#x7A0B; <a href="#t01. &#x8FDB;&#x7A0B;"> # </a></h2>
<ul>
<li>&#x5728;Node.js&#x4E2D;&#x6BCF;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x90FD;&#x662F;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x3002;</li>
<li>&#x4F7F;&#x7528;<code>process</code>&#x5BF9;&#x8C61;&#x4EE3;&#x8868;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;,&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x5BF9;&#x8C61;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5B83;&#x6765;&#x83B7;&#x53D6;Node.jsy&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4EE5;&#x53CA;&#x8FD0;&#x884C;&#x8BE5;&#x7A0B;&#x5E8F;&#x7684;&#x7528;&#x6237;&#x3001;&#x73AF;&#x5883;&#x7B49;&#x5404;&#x79CD;&#x4FE1;&#x606F;&#x7684;&#x5C5E;&#x6027;&#x3001;&#x65B9;&#x6CD5;&#x548C;&#x4E8B;&#x4EF6;&#x3002;</li>
</ul>
<h3 id="t11.1 &#x8FDB;&#x7A0B;&#x5BF9;&#x8C61;&#x5C5E;&#x6027;">1.1 &#x8FDB;&#x7A0B;&#x5BF9;&#x8C61;&#x5C5E;&#x6027; <a href="#t11.1 &#x8FDB;&#x7A0B;&#x5BF9;&#x8C61;&#x5C5E;&#x6027;"> # </a></h3>
<ul>
<li>execPath &#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x7684;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;,&#x5982; <code>/usr/local/bin/node</code></li>
<li>version &#x7248;&#x672C;&#x53F7;</li>
<li>versions &#x4F9D;&#x8D56;&#x5E93;&#x7684;&#x7248;&#x672C;&#x53F7;</li>
<li>platform &#x8FD0;&#x884C;&#x5E73;&#x53F0;&#x3002; &#x5982; darwin&#x3001;freebsd&#x3001;linux&#x3001;sunos&#x3001;win32</li>
<li>stdin &#x6807;&#x51C6;&#x8F93;&#x5165;&#x6D41;&#x53EF;&#x8BFB;&#x6D41;&#xFF0C;&#x9ED8;&#x8BA4;&#x6682;&#x505C;&#x72B6;&#x6001;</li>
<li>stdout &#x6807;&#x51C6;&#x8F93;&#x51FA;&#x53EF;&#x5199;&#x6D41;&#xFF0C;&#x540C;&#x6B65;&#x64CD;&#x4F5C; </li>
<li>stderr &#x9519;&#x8BEF;&#x8F93;&#x51FA;&#x53EF;&#x5199;&#x6D41;&#xFF0C;&#x540C;&#x6B65;&#x64CD;&#x4F5C;</li>
<li>argv &#x5C5E;&#x6027;&#x503C;&#x4E3A;&#x6570;&#x7EC4;</li>
<li>env &#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x73AF;&#x5883;&#x4FE1;&#x606F;</li>
<li>pid &#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8FDB;&#x7A0B;ID</li>
<li>title &#x7A97;&#x53E3;&#x6807;&#x9898;</li>
<li>arch &#x5904;&#x7406;&#x5668;&#x67B6;&#x6784; arm ia32 x64</li>
</ul>
<pre><code class="lang-javascript">process.stdin.resume();
process.stdin.on(&apos;data&apos;,function(chunk){
  process.stdout.write(`&#x8FDB;&#x7A0B;&#x63A5;&#x6536;&#x5230;&#x6570;&#x636E;: `+chunk);
});
</code></pre>
<pre><code class="lang-javascript">process.argv.forEach((val,index,ary)=&gt; console.log(index,val));
</code></pre>
<h3 id="t21.2 memoryUsage&#x65B9;&#x6CD5;">1.2 memoryUsage&#x65B9;&#x6CD5; <a href="#t21.2 memoryUsage&#x65B9;&#x6CD5;"> # </a></h3>
<pre><code class="lang-javascript">process.memoryUsage()
</code></pre>
<p><img src="http://img.zhufengpeixun.cn/stack.png" alt="stack"></p>
<ul>
<li>rss&#xFF08;resident set size&#xFF09;&#xFF1A;&#x6240;&#x6709;&#x5185;&#x5B58;&#x5360;&#x7528;&#xFF0C;&#x5305;&#x62EC;&#x6307;&#x4EE4;&#x533A;&#x548C;&#x5806;&#x6808;&#x3002;</li>
<li>heapTotal&#xFF1A;&quot;&#x5806;&quot;&#x5360;&#x7528;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x5305;&#x62EC;&#x7528;&#x5230;&#x7684;&#x548C;&#x6CA1;&#x7528;&#x5230;&#x7684;&#x3002;</li>
<li>heapUsed&#xFF1A;&#x7528;&#x5230;&#x7684;&#x5806;&#x7684;&#x90E8;&#x5206;&#x3002;</li>
<li>external&#xFF1A; V8 &#x5F15;&#x64CE;&#x5185;&#x90E8;&#x7684; C++ &#x5BF9;&#x8C61;&#x5360;&#x7528;&#x7684;&#x5185;&#x5B58;&#x3002;</li>
</ul>
<h3 id="t31.3 nextTick&#x65B9;&#x6CD5;">1.3 nextTick&#x65B9;&#x6CD5; <a href="#t31.3 nextTick&#x65B9;&#x6CD5;"> # </a></h3>
<p>nextTick&#x65B9;&#x6CD5;&#x7528;&#x4E8E;&#x5C06;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x63A8;&#x8FDF;&#x5230;&#x4EE3;&#x7801;&#x4E2D;&#x6240;&#x4E66;&#x5199;&#x7684;&#x4E0B;&#x4E00;&#x4E2A;&#x540C;&#x6B65;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x6216;&#x5F02;&#x6B65;&#x65B9;&#x6CD5;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x5F00;&#x59CB;&#x6267;&#x884C;&#x524D;&#x8C03;&#x7528;</p>
<h3 id="t41.4 chdir">1.4 chdir <a href="#t41.4 chdir"> # </a></h3>
<p>chdir&#x65B9;&#x6CD5;&#x7528;&#x4E8E;&#x4FEE;&#x6539;Node.js&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x4F7F;&#x7528;&#x7684;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#xFF0C;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x5982;&#x4E0B; </p>
<pre><code class="lang-javascript">process.chdir(directory);
</code></pre>
<h3 id="t51.5 cwd &#x65B9;&#x6CD5;">1.5 cwd &#x65B9;&#x6CD5; <a href="#t51.5 cwd &#x65B9;&#x6CD5;"> # </a></h3>
<p>cwd&#x65B9;&#x6CD5;&#x7528;&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#xFF0C;&#x4E0D;&#x4F7F;&#x7528;&#x4EFB;&#x4F55;&#x53C2;&#x6570;</p>
<pre><code class="lang-javascript">console.log(process.cwd());
</code></pre>
<h3 id="t61.6 chdir &#x65B9;&#x6CD5;">1.6 chdir &#x65B9;&#x6CD5; <a href="#t61.6 chdir &#x65B9;&#x6CD5;"> # </a></h3>
<p>&#x6539;&#x53D8;&#x5F53;&#x524D;&#x7684;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;</p>
<pre><code class="lang-javascript">console.log(`&#x5F53;&#x524D;&#x76EE;&#x5F55;: ${process.cwd()}`);
process.chdir(&apos;..);
console.log(`&#x4E0A;&#x5C42;&#x76EE;&#x5F55;: ${process.cwd()});
</code></pre>
<h3 id="t71.7 exit &#x65B9;&#x6CD5;">1.7 exit &#x65B9;&#x6CD5; <a href="#t71.7 exit &#x65B9;&#x6CD5;"> # </a></h3>
<p>&#x9000;&#x51FA;&#x8FD0;&#x884C;Node.js&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x8FDB;&#x7A0B;</p>
<pre><code class="lang-javascript">process.exit(0);
</code></pre>
<h3 id="t81.8 kill&#x65B9;&#x6CD5;">1.8 kill&#x65B9;&#x6CD5; <a href="#t81.8 kill&#x65B9;&#x6CD5;"> # </a></h3>
<p>&#x7528;&#x4E8E;&#x5411;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;</p>
<ul>
<li>SIGINT &#x7A0B;&#x5E8F;&#x7EC8;&#x6B62;(interrupt)&#x4FE1;&#x53F7;, &#x5728;&#x7528;&#x6237;&#x952E;&#x5165;INTR&#x5B57;&#x7B26;(&#x901A;&#x5E38;&#x662F;Ctrl-C)&#x65F6;&#x53D1;&#x51FA;&#xFF0C;&#x7528;&#x4E8E;&#x901A;&#x77E5;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;&#x3002;</li>
<li>SIGTERM &#x7A0B;&#x5E8F;&#x7ED3;&#x675F;(terminate)&#x4FE1;&#x53F7;, &#x8BE5;&#x4FE1;&#x53F7;&#x53EF;&#x4EE5;&#x88AB;&#x963B;&#x585E;&#x548C;&#x5904;&#x7406;&#x3002;&#x901A;&#x5E38;&#x7528;&#x6765;&#x8981;&#x6C42;&#x7A0B;&#x5E8F;&#x81EA;&#x5DF1;&#x6B63;&#x5E38;&#x9000;&#x51FA;&#xFF0C;shell&#x547D;&#x4EE4;kill&#x7F3A;&#x7701;&#x4EA7;&#x751F;&#x8FD9;&#x4E2A;&#x4FE1;&#x53F7;</li>
</ul>
<pre><code class="lang-javascript">process.kill(pid,[signal]);
</code></pre>
<ul>
<li>pid&#x662F;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x9700;&#x8981;&#x63A5;&#x6536;&#x4FE1;&#x53F7;&#x7684;&#x8FDB;&#x7A0B;ID</li>
<li>signal  &#x53D1;&#x9001;&#x7684;&#x4FE1;&#x53F7;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A; SIGTERM</li>
</ul>
<h3 id="t91.9 uptime">1.9 uptime <a href="#t91.9 uptime"> # </a></h3>
<p>&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x7A0B;&#x5E8F;&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x95F4;</p>
<pre><code class="lang-javascript">process.uptime()
</code></pre>
<h3 id="t101.10 hrtime">1.10 hrtime <a href="#t101.10 hrtime"> # </a></h3>
<p>&#x6D4B;&#x8BD5;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x6BB5;&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x95F4;,&#x8FD4;&#x56DE;&#x4E24;&#x4E2A;&#x65F6;&#x95F4;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x5355;&#x4F4D;&#x662F;&#x79D2;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x5355;&#x4F4D;&#x662F;&#x7EB3;&#x79D2;</p>
<pre><code class="lang-javascript">let fs = require(&apos;fs);
let time = process.hrtime();
let data = fs.readFileSync(&apos;index.txt&apos;);
let diff = process.hrtime(time);
console.log(`&#x8BFB;&#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x8017;&#x8D39;&#x7684;%d&#x79D2;`,diff[0]);
</code></pre>
<h3 id="t111.11 exit&#x4E8B;&#x4EF6;">1.11 exit&#x4E8B;&#x4EF6; <a href="#t111.11 exit&#x4E8B;&#x4EF6;"> # </a></h3>
<p>&#x5F53;&#x8FD0;&#x884C;Node.js&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x65F6;&#x89E6;&#x53D1;&#x8FDB;&#x7A0B;&#x5BF9;&#x8C61;&#x7684;exit&#x4E8B;&#x4EF6;&#x3002;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6307;&#x5B9A;&#x4E8B;&#x4EF6;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x6765;&#x6307;&#x5B9A;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x65F6;&#x6240;&#x6267;&#x884C;&#x7684;&#x5904;&#x7406;&#x3002;</p>
<pre><code class="lang-javascript">process.on(&apos;exit&apos;,function(){
    console.log(&apos;Node.js&#x8FDB;&#x7A0B;&#x88AB;&#x63A8;&#x51FA;);
});
process.exit();
</code></pre>
<h3 id="t121.12 uncaughtException&#x4E8B;&#x4EF6;">1.12 uncaughtException&#x4E8B;&#x4EF6; <a href="#t121.12 uncaughtException&#x4E8B;&#x4EF6;"> # </a></h3>
<p>&#x5F53;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x672A;&#x88AB;&#x6355;&#x83B7;&#x7684;&#x5F02;&#x5E38;&#x65F6;&#x89E6;&#x53D1;&#x8FDB;&#x7A0B;&#x5BF9;&#x8C61;&#x7684;uncaughtException&#x4E8B;&#x4EF6;</p>
<pre><code class="lang-javascript">process.on(&apos;uncaughtException&apos;,function(err){
  console.log(&apos;&#x6355;&#x83B7;&#x5230;&#x4E00;&#x4E2A;&#x672A;&#x88AB;&#x5904;&#x7406;&#x7684;&#x9519;&#x8BEF;:&apos;,err);
});
notExist();
</code></pre>
<h3 id="t131.13 &#x4FE1;&#x53F7;&#x4E8B;&#x4EF6;">1.13 &#x4FE1;&#x53F7;&#x4E8B;&#x4EF6; <a href="#t131.13 &#x4FE1;&#x53F7;&#x4E8B;&#x4EF6;"> # </a></h3>
<pre><code class="lang-javascript">process.stdin.resume();
process.on(&apos;SIGINT&apos;,function(){
    console.log(&apos;&#x63A5;&#x6536;&#x5230;SIGINT&#x4FE1;&#x53F7;&apos;);
});
</code></pre>
<h2 id="t142. &#x5B50;&#x8FDB;&#x7A0B;">2. &#x5B50;&#x8FDB;&#x7A0B; <a href="#t142. &#x5B50;&#x8FDB;&#x7A0B;"> # </a></h2>
<ul>
<li>&#x5728;Node.js&#x4E2D;&#xFF0C;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x6240;&#x6709;&#x64CD;&#x4F5C;&#xFF0C;&#x5982;&#x679C;&#x67D0;&#x4E2A;&#x64CD;&#x4F5C;&#x9700;&#x8981;&#x5927;&#x91CF;&#x6D88;&#x8017;CPU&#x8D44;&#x6E90;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x540E;&#x7EED;&#x64CD;&#x4F5C;&#x90FD;&#x9700;&#x8981;&#x7B49;&#x5F85;&#x3002;</li>
<li>&#x5728;Node.js&#x4E2D;&#xFF0C;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;<code>child_process</code>&#x6A21;&#x5757;,&#x901A;&#x8FC7;&#x5B83;&#x53EF;&#x4EE5;&#x5F00;&#x542F;&#x591A;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x5728;&#x591A;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x53EF;&#x4EE5;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x4E92;&#x76F8;&#x901A;&#x4FE1;&#x6765;&#x5B9E;&#x73B0;&#x4FE1;&#x606F;&#x7684;&#x4EA4;&#x6362;&#x3002;<h3 id="t152.1 spawn">2.1 spawn <a href="#t152.1 spawn"> # </a></h3>
<h4 id="t162.1.1 &#x8BED;&#x6CD5;">2.1.1 &#x8BED;&#x6CD5; <a href="#t162.1.1 &#x8BED;&#x6CD5;"> # </a></h4>
<pre><code class="lang-javascript">child_process.spawn(command,[args],[options]);
</code></pre>
</li>
<li>command &#x5FC5;&#x987B;&#x6307;&#x5B9A;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x6307;&#x5B9A;&#x9700;&#x8981;&#x6267;&#x884C;&#x7684;&#x547D;&#x4EE4;</li>
<li>args &#x6570;&#x7EC4;&#xFF0C;&#x5B58;&#x653E;&#x4E86;&#x6240;&#x6709;&#x8FD0;&#x884C;&#x8BE5;&#x547D;&#x4EE4;&#x9700;&#x8981;&#x7684;&#x53C2;&#x6570;</li>
<li>options &#x53C2;&#x6570;&#x4E3A;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x5F00;&#x542F;&#x5B50;&#x8FDB;&#x7A0B;&#x65F6;&#x4F7F;&#x7528;&#x7684;&#x9009;&#x9879;<ul>
<li>cwd &#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;</li>
<li>env &#x73AF;&#x5883;&#x53D8;&#x91CF;</li>
<li>detached &#x5982;&#x679C;&#x4E3A;true,&#x8BE5;&#x5B50;&#x8FDB;&#x7A0B;&#x9B4F;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x9886;&#x5934;&#x8FDB;&#x7A0B;&#xFF0C;&#x5F53;&#x7236;&#x8FDB;&#x7A0B;&#x4E0D;&#x5B58;&#x5728;&#x65F6;&#x4E5F;&#x53EF;&#x4EE5;&#x72EC;&#x7ACB;&#x5B58;&#x5728;</li>
<li>stdio &#x4E09;&#x4E2A;&#x5143;&#x7D20;&#x7684;&#x6570;&#x7EC4;&#xFF0C;&#x8BBE;&#x7F6E;&#x6807;&#x51C6;&#x8F93;&#x5165;/&#x8F93;&#x51FA;<ul>
<li>pipe &#x5728;&#x7236;&#x8FDB;&#x7A0B;&#x548C;&#x5B50;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7BA1;&#x9053;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;stdio[0]&#x8BBF;&#x95EE;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x6807;&#x51C6;&#x8F93;&#x5165;&#xFF0C;&#x901A;&#x8FC7;stdio[1]&#x8BBF;&#x95EE;&#x6807;&#x51C6;&#x8F93;&#x51FA;,stdio[2]&#x8BBF;&#x95EE;&#x9519;&#x8BEF;&#x8F93;&#x51FA;</li>
<li>ipc &#x5728;&#x7236;&#x8FDB;&#x7A0B;&#x548C;&#x5B50;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x4E13;&#x7528;&#x4E0E;&#x4F20;&#x9012;&#x6D88;&#x606F;&#x7684;IPC&#x901A;&#x9053;&#x3002;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;send&#x65B9;&#x6CD5;&#x5411;&#x5B50;&#x8FDB;&#x7A0B;&#x53D1;&#x6D88;&#x606F;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x4F1A;&#x89E6;&#x53D1;<code>message</code>&#x4E8B;&#x4EF6;</li>
<li>ignore &#x6307;&#x5B9A;&#x4E0D;&#x4E3A;&#x5B50;&#x8FDB;&#x7A0B;&#x8BBE;&#x7F6E;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;&#x8FD9;&#x6837;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x3001;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x548C;&#x9519;&#x8BEF;&#x8F93;&#x51FA;&#x88AB;&#x5FFD;&#x7565;</li>
<li>stream &#x5B50;&#x8FDB;&#x7A0B;&#x548C;&#x7236;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;&#x4E00;&#x4E2A;&#x7EC8;&#x7AEF;&#x8BBE;&#x5907;&#x3001;&#x6587;&#x4EF6;&#x3001;&#x7AEF;&#x53E3;&#x6216;&#x7BA1;&#x9053;</li>
<li>&#x6B63;&#x6574;&#x6570;&#x503C; &#x548C;&#x5171;&#x4EAB;&#x4E00;&#x4E2A;steam&#x662F;&#x4E00;&#x6837;&#x7684;</li>
<li>null&#x6216;undefined &#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x521B;&#x5EFA;&#x4E0E;&#x7236;&#x8FDB;&#x7A0B;&#x76F8;&#x8FDE;&#x7684;&#x7BA1;&#x9053;</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;stdin,stdout,stderr&#x5BFC;&#x5411;&#x4E86;ChildProcess&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;child.stdin,child.stdout,child.stderr&#x6D41;,</p>
<pre><code class="lang-javascript">let spawn = require(&apos;child_process&apos;).spawn;
sapwn(&apos;prg&apos;,[],{stdio:[&apos;pipe&apos;,&apos;pipe&apos;,process.stderr]});
</code></pre>
<ul>
<li>ignore [&apos;ignore&apos;,&apos;ignore&apos;,&apos;ignore&apos;] &#x5168;&#x90E8;&#x5FFD;&#x7565;</li>
<li>pipe [&apos;pipe&apos;,&apos;pipe&apos;,&apos;pipe&apos;] &#x901A;&#x8FC7;&#x7BA1;&#x9053;&#x8FDE;&#x63A5;</li>
<li>inherit [process.stdin,process.stdout,process.stderr]&#x6216;[0,1,2] &#x548C;&#x7236;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;&#x8F93;&#x5165;&#x8F93;&#x51FA;</li>
</ul>
<pre><code class="lang-javascript">let spawn = require(&apos;child_process&apos;).spawn;
spawn(&apos;prg&apos;,[],{stdio:&apos;inherit&apos;});
</code></pre>
<ul>
<li>spawn&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x9690;&#x5F0F;&#x521B;&#x5EFA;&#x7684;&#x4EE3;&#x8868;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;ChildProcess&#x5BF9;&#x8C61;</li>
<li>&#x5B50;&#x8FDB;&#x7A0B;&#x5BF9;&#x8C61;&#x540C;&#x6837;&#x62E5;&#x6709;stdin&#x5C5E;&#x6027;&#x503C;&#x4E3A;&#x4E00;&#x4E2A;&#x53EF;&#x7528;&#x4E8E;&#x8BFB;&#x5165;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x6D41;&#x5BF9;&#x8C61;</li>
<li>&#x5B50;&#x8FDB;&#x7A0B;&#x5BF9;&#x8C61;&#x540C;&#x6837;&#x62E5;&#x6709;stdiout&#x5C5E;&#x6027;&#x503C;&#x548C;stderr&#x5C5E;&#x6027;&#x503C;&#x53EF;&#x5206;&#x522B;&#x7528;&#x4E8E;&#x5199;&#x5165;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x6D41;&#x4E0E;&#x6807;&#x51C6;&#x9519;&#x8BEF;&#x8F93;&#x51FA;&#x6D41;</li>
</ul>
<h4 id="t172.1.2 close">2.1.2 close <a href="#t172.1.2 close"> # </a></h4>
<ul>
<li>&#x5F53;&#x5B50;&#x8FDB;&#x7A0B;&#x6240;&#x6709;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x90FD;&#x7EC8;&#x6B62;&#x65F6;&#xFF0C;&#x4F1A;&#x89E6;&#x53D1;&#x5B50;&#x8FDB;&#x7A0B;&#x5BF9;&#x8C61;&#x7684;close&#x4E8B;&#x4EF6;&#x3002;<pre><code class="lang-javascript">child.on(&apos;close&apos;,function(code,signal){});
</code></pre>
<ul>
<li>code &#x4E3A;0&#x8868;&#x793A;&#x6B63;&#x5E38;&#x63A8;&#x51FA;&#xFF0C;&#x4E3A;null&#x8868;&#x793A;&#x5F02;&#x5E38;&#x9000;&#x51FA;</li>
<li>&#x5F53;&#x5728;&#x7236;&#x8FDB;&#x7A0B;&#x4E2D;&#x5173;&#x95ED;&#x5B50;&#x8FDB;&#x7A0B;&#x65F6;&#xFF0C;signal&#x53C2;&#x6570;&#x503C;&#x4E3A;&#x7236;&#x8FDB;&#x7A0B;&#x53D1;&#x7ED9;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x4FE1;&#x53F7;&#x540D;&#x79F0;</li>
</ul>
</li>
</ul>
<h4 id="t182.1.3 exit">2.1.3 exit <a href="#t182.1.3 exit"> # </a></h4>
<ul>
<li>&#x5F53;&#x5B50;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x65F6;&#xFF0C;&#x89E6;&#x53D1;&#x5B50;&#x8FDB;&#x7A0B;&#x5BF9;&#x8C61;&#x7684;exit&#x4E8B;&#x4EF6;</li>
<li><p>&#x56E0;&#x4E3A;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x53EF;&#x80FD;&#x4F1A;&#x5171;&#x4EAB;i &#x4E2A;&#x8F93;&#x5165;/&#x8F93;&#x51FA;&#xFF0C;&#x6240;&#x4EE5;&#x5F53;&#x5B50;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x65F6;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8F93;&#x5165;/&#x8F93;&#x51FA;&#x53EF;&#x80FD;&#x5E76;&#x672A;&#x7EC8;&#x6B62;</p>
<pre><code class="lang-javascript">child.on(&apos;exit&apos;,function(code,signal){});
</code></pre>
<h4 id="t192.1.4 error">2.1.4 error <a href="#t192.1.4 error"> # </a></h4>
<p>&#x5982;&#x679C;&#x5B50;&#x8FDB;&#x7A0B;&#x5F00;&#x542F;&#x5931;&#x8D25;&#xFF0C;&#x90A3;&#x4E48;&#x5C06;&#x4F1A;&#x89E6;&#x53D1;&#x5B50;&#x8FDB;&#x7A0B;&#x5BF9;&#x8C61;&#x7684;error&#x4E8B;&#x4EF6;</p>
<pre><code class="lang-javascript">child1.on(&apos;error&apos;, function (err) {
  console.log(err);
});
</code></pre>
<h4 id="t202.1.5 kill">2.1.5 kill <a href="#t202.1.5 kill"> # </a></h4>
</li>
<li>&#x7236;&#x8FDB;&#x7A0B;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;kill&#x65B9;&#x6CD5;&#x5411;&#x5B50;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4FE1;&#x53F7;,&#x53C2;&#x6570;&#x4E3A;&#x63CF;&#x8FF0;&#x8BE5;&#x4FE1;&#x53F7;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x9ED8;&#x8BA4;&#x53C2;&#x6570;&#x503C;&#x4E3A;<code>SIGTERM</code></li>
<li>SIGTERM &#x7A0B;&#x5E8F;&#x7ED3;&#x675F;(terminate)&#x4FE1;&#x53F7;, &#x4E0E;SIGKILL&#x4E0D;&#x540C;&#x7684;&#x662F;&#x8BE5;&#x4FE1;&#x53F7;&#x53EF;&#x4EE5;&#x88AB;&#x963B;&#x585E;&#x548C;&#x5904;&#x7406;. &#x901A;&#x5E38;&#x7528;&#x6765;&#x8981;&#x6C42;&#x7A0B;&#x5E8F;&#x81EA;&#x5DF1;&#x6B63;&#x5E38;&#x9000;&#x51FA;</li>
</ul>
<pre><code class="lang-javascript">child.kill([signal]);
</code></pre>
<h4 id="t212.1.6 &#x6848;&#x4F8B;">2.1.6 &#x6848;&#x4F8B; <a href="#t212.1.6 &#x6848;&#x4F8B;"> # </a></h4>
<ol>
<li>spawn.js<pre><code class="lang-javascript">let path = require(&apos;path&apos;);
let {
 spawn
} = require(&apos;child_process&apos;);
//&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;stdin,stdout,stderr&#x5BFC;&#x5411;&#x4E86;ChildProcess&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;child.stdin,child.stdout,child.stderr&#x6D41;,
//&#x8FD9;&#x548C;&#x8BBE;&#x7F6E;stdio&#x4E3A;[&apos;pipe&apos;, &apos;pipe&apos;, &apos;pipe&apos;]&#x662F;&#x4E00;&#x6837;&#x7684;
let p1 = spawn(&apos;node&apos;, [&apos;test1.js&apos;, &apos;a&apos;], {
 cwd: path.join(__dirname, &apos;test1&apos;)
});
let p2 = spawn(&apos;node&apos;, [&apos;test3.js&apos;], {
 cwd: path.join(__dirname, &apos;test3&apos;),
 stdio: &apos;pipe&apos;
});
//&#x76D1;&#x542C;test1.js&#x811A;&#x672C;&#x5B50;&#x8FDB;&#x7A0B;&#x5BF9;&#x8C61;&#x7684;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x7684;data&#x4E8B;&#x4EF6;&#xFF0C;&#x628A;&#x6570;&#x636E;&#x5199;&#x7ED9;p2
p1.stdout.on(&apos;data&apos;, function (data) {
 console.log(&apos;P1:&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x6807;&#x51C6;&#x8F93;&#x51FA;:&apos; + data);
 p2.stdin.write(data);
});
p1.on(&apos;error&apos;, function () {
 console.log(&apos;p1:&#x5B50;&#x8FDB;&#x7A0B;1&#x5F00;&#x542F;&#x5931;&#x8D25;&apos;);
});
p2.on(&apos;error&apos;, function () {
 console.log(&apos;p2:&#x5B50;&#x8FDB;&#x7A0B;2&#x5F00;&#x542F;&#x5931;&#x8D25;&apos;);
});
</code></pre>
</li>
<li><p>test1.js</p>
<pre><code class="lang-javascript">process.stdout.write(&apos;p1:&#x5B50;&#x8FDB;&#x7A0B;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x4E3A;:&apos; + process.cwd() + &apos;\r\n&apos;);
process.stdout.write(&apos;p1:&apos; + process.argv[2] + &apos; \r\n&apos;);
</code></pre>
</li>
<li><p>test2.js</p>
<pre><code class="lang-javascript">let fs = require(&apos;fs&apos;);
let path = require(&apos;path&apos;);
let out = fs.createWriteStream(path.join(__dirname, &apos;msg.txt&apos;));
process.stdin.on(&apos;data&apos;, function (data) {
 out.write(data);
});
process.stdin.on(&apos;end&apos;, function () {
 process.exit();
});
</code></pre>
</li>
</ol>
<h4 id="t222.1.7 detached">2.1.7 detached <a href="#t222.1.7 detached"> # </a></h4>
<ul>
<li>&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x53EA;&#x6709;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x5168;&#x90E8;&#x9000;&#x51FA;&#x540E;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x624D;&#x80FD;&#x9000;&#x51FA;&#x3002;&#x4E3A;&#x4E86;&#x8BA9;&#x7236;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x5148;&#x9000;&#x51FA;&#xFF0C;&#x800C;&#x8BA9;&#x5B50;&#x8FDB;&#x7A0B;&#x7EE7;&#x7EED;&#x8FDB;&#x884C;I/O&#x64CD;&#x4F5C;,&#x53EF;&#x4EE5;&#x5728;spawn&#x65B9;&#x6CD5;&#x4E2D;&#x4F7F;&#x7528;options&#x53C2;&#x6570;&#xFF0C;&#x628A;detached&#x5C5E;&#x6027;&#x503C;&#x8BBE;&#x7F6E;&#x4E3A;true</li>
<li>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x7236;&#x8FDB;&#x7A0B;&#x4F1A;&#x7B49;&#x5F85;&#x6240;&#x6709;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x540E;&#x624D;&#x53EF;&#x4EE5;&#x9000;&#x51FA;&#xFF0C;&#x4F7F;&#x7528;subprocess.unref&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x8BA9;&#x7236;&#x8FDB;&#x7A0B;&#x4E0D;&#x7528;&#x7B49;&#x5F85;&#x5B50;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x5C31;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x9000;&#x51FA;<pre><code class="lang-javascript">let cp = require(&apos;child_process&apos;);
let fs = require(&apos;fs&apos;);
let path = require(&apos;path&apos;);
let out = fs.openSync(path.join(__dirname, &apos;msg.txt&apos;), &apos;w&apos;, 0o666);
let sp = cp.spawn(&apos;node&apos;, [&apos;4.detached.js&apos;], {
  detached: true,
  stdio: [&apos;ignore&apos;, out, &apos;ignore&apos;]
});
sp.unref();
</code></pre>
</li>
</ul>
<pre><code class="lang-javascript">let count = 10;
let $timer = setInterval(() =&gt; {
    process.stdout.write(new Date().toString() + &apos;\r\n&apos;);
    if (--count == 0) {
        clearInterval($timer);
    }
}, 500);
`
</code></pre>
<h3 id="t232.2 fork&#x5F00;&#x542F;&#x5B50;&#x8FDB;&#x7A0B;">2.2 fork&#x5F00;&#x542F;&#x5B50;&#x8FDB;&#x7A0B; <a href="#t232.2 fork&#x5F00;&#x542F;&#x5B50;&#x8FDB;&#x7A0B;"> # </a></h3>
<ul>
<li>&#x884D;&#x751F;&#x4E00;&#x4E2A;&#x65B0;&#x7684; Node.js &#x8FDB;&#x7A0B;&#xFF0C;&#x5E76;&#x901A;&#x8FC7;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A; IPC &#x901A;&#x8BAF;&#x901A;&#x9053;&#x6765;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x6307;&#x5B9A;&#x7684;&#x6A21;&#x5757;&#xFF0C;&#x8BE5;&#x901A;&#x9053;&#x5141;&#x8BB8;&#x7236;&#x8FDB;&#x7A0B;&#x4E0E;&#x5B50;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x76F8;&#x4E92;&#x53D1;&#x9001;&#x4FE1;&#x606F;</li>
<li>fork&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x9690;&#x5F0F;&#x521B;&#x5EFA;&#x7684;&#x4EE3;&#x8868;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;ChildProcess&#x5BF9;&#x8C61;</li>
<li>&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8F93;&#x5165;/&#x8F93;&#x51FA;&#x64CD;&#x4F5C;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x540E;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x4E0D;&#x4F1A;&#x81EA;&#x52A8;&#x9000;&#x51FA;&#xFF0C;&#x5FC5;&#x987B;&#x4F7F;&#x7528;<code>process.exit()</code>&#x65B9;&#x6CD5;&#x663E;&#x5F0F;&#x9000;&#x51FA;</li>
</ul>
<pre><code class="lang-javascript">child_process.fork(modulePath,[args],[options]);
</code></pre>
<ul>
<li>args &#x8FD0;&#x884C;&#x8BE5;&#x6587;&#x4EF6;&#x6A21;&#x5757;&#x6587;&#x4EF6;&#x65F6;&#x8BB8;&#x54DF;&#x554A;&#x4F7F;&#x7528;&#x7684;&#x53C2;&#x6570;</li>
<li>options &#x9009;&#x9879;&#x5BF9;&#x8C61;<ul>
<li>cwd &#x6307;&#x5B9A;&#x5B50;&#x8FDB;&#x7A0B;&#x5F53;&#x524D;&#x7684;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;</li>
<li>env &#x5C5E;&#x6027;&#x503C;&#x4E3A;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x7528;&#x4E8E;&#x4EE5;&quot;&#x952E;&#x540D;/&#x952E;&#x503C;&quot;&#x7684;&#x5F62;&#x5F0F;&#x4E3A;&#x5B50;&#x8FDB;&#x7A0B;&#x6307;&#x5B9A;&#x73AF;&#x5883;&#x53D8;&#x91CF;</li>
<li>encoding &#x5C5E;&#x6027;&#x503C;&#x4E3A;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x8F93;&#x51FA;&#x53CA;&#x6807;&#x51C6;&#x9519;&#x8BEF;&#x8F93;&#x51FA;&#x6570;&#x636E;&#x7684;&#x7F16;&#x7801;&#x683C;&#x5F0F;&#xFF0C;&#x9ED8;&#x8BA4;&#x503C;&#x4E3A;&apos;utf8&apos;</li>
<li>silent &#x5C5E;&#x6027;&#x503C;&#x4E3A;&#x5E03;&#x5C14;&#x503C;&#xFF0C;&#x5F53;&#x5C5E;&#x6027;&#x503C;&#x4E3A;false&#x65F6;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x548C;&#x7236;&#x8FDB;&#x7A0B;&#x5BF9;&#x8C61;&#x5171;&#x4EAB;&#x6807;&#x51C6;(&#x8F93;&#x5165;/&#x8F93;&#x51FA;),true&#x65F6;&#x4E0D;&#x5171;&#x4EAB;</li>
</ul>
</li>
</ul>
<h4 id="t242.2.1 &#x53D1;&#x9001;&#x6D88;&#x606F;">2.2.1 &#x53D1;&#x9001;&#x6D88;&#x606F; <a href="#t242.2.1 &#x53D1;&#x9001;&#x6D88;&#x606F;"> # </a></h4>
<pre><code class="lang-javascript">child.send(message,[sendHandle]);//&#x5728;&#x7236;&#x8FDB;&#x7A0B;&#x4E2D;&#x5411;&#x5B50;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x6D88;&#x606F;
process.send(message,[sendHandle]);//&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x5411;&#x4E3B;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x6D88;&#x606F;
</code></pre>
<ul>
<li>message&#x662F;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x9700;&#x8981;&#x53D1;&#x9001;&#x7684;&#x6D88;&#x606F;</li>
<li>sendHandle&#x662F;&#x4E00;&#x4E2A; net.Socket &#x6216; net.Server &#x5BF9;&#x8C61;</li>
<li>&#x5B50;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x76D1;&#x542C;&#x7236;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x7684;message&#x4E8B;&#x4EF6;<pre><code class="lang-javascript">process.on(&apos;message&apos;,function(m,setHandle){});
</code></pre>
</li>
<li>m &#x53C2;&#x6570;&#x503C;&#x4E3A;&#x5B50;&#x8FDB;&#x7A0B;&#x6536;&#x5230;&#x7684;&#x6D88;&#x606F;</li>
<li>sendHandle&#x4E3A;&#x670D;&#x52A1;&#x5668;&#x5BF9;&#x8C61;&#x6216;socket&#x7AEF;&#x53E3;&#x5BF9;&#x8C61;</li>
</ul>
<p>&#x5F53;&#x7236;&#x8FDB;&#x7A0B;&#x6536;&#x5230;&#x5B50;&#x8FDB;&#x7A0B;&#x53D1;&#x51FA;&#x7684;&#x6D88;&#x606F;&#x65F6;&#xFF0C;&#x89E6;&#x53D1;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;message&#x4E8B;&#x4EF6;</p>
<pre><code class="lang-javascript">child.on(&apos;message&apos;,function(m,setHandle){
  //TODO&#x4E8B;&#x4EF6;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x4EE3;&#x7801;
});
</code></pre>
<p>5.fork.js</p>
<pre><code class="lang-javascript">let {
    fork
} = require(&apos;child_process&apos;);
let path = require(&apos;path&apos;);
let child = fork(path.join(__dirname, &apos;fork.js&apos;));
child.on(&apos;message&apos;, function (m) {
    console.log(&apos;&#x7236;&#x8FDB;&#x7A0B;&#x63A5;&#x6536;&#x5230;&#x6D88;&#x606F;:&apos;, m);
    process.exit();
});
child.send({
    name: &apos;zfpx&apos;
});
child.on(&apos;error&apos;, function (err) {
    console.error(arguments);
});
</code></pre>
<p>fork.js</p>
<pre><code class="lang-javascript">process.on(&apos;message&apos;, function (m, setHandle) {
    console.log(&apos;&#x5B50;&#x8FDB;&#x7A0B;&#x6536;&#x5230;&#x6D88;&#x606F;:&apos;, m);
    process.send({
        age: 9
    });
})
</code></pre>
<h4 id="t252.2.2 silent">2.2.2 silent <a href="#t252.2.2 silent"> # </a></h4>
<p>&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x5B50;&#x8FDB;&#x7A0B;&#x5BF9;&#x8C61;&#x4E0E;&#x7236;&#x8FDB;&#x7A0B;&#x5BF9;&#x8C61;&#x5171;&#x4EAB;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x548C;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x3002;&#x5982;&#x679C;&#x8981;&#x8BA9;&#x5B50;&#x8FDB;&#x7A0B;&#x5BF9;&#x8C61;&#x7528;&#x72EC;&#x7ACB;&#x7684;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;silent&#x5C5E;&#x6027;&#x503C;&#x8BBE;&#x7F6E;&#x4E3A; true
forkslient.js</p>
<pre><code class="lang-javascript">let {
    fork
} = require(&apos;child_process&apos;);
let path = require(&apos;path&apos;);

let p1 = fork(&apos;node&apos;, [path.join(__dirname, &apos;fork1.js&apos;)], {
    silent: true
});
let p2 = fork(&apos;node&apos;,path.join(__dirname, &apos;fork2.js&apos;));
p1.stdout.on(&apos;data&apos;, function (data) {
    console.log(&apos;&#x5B50;&#x8FDB;&#x7A0B;1&#x6807;&#x51C6;&#x8F93;&#x51FA;&#xFF1A;&apos; + data);
    p2.send(data.toString());
});
p1.on(&apos;exit&apos;, function (code, signal) {
    console.log(&apos;&#x5B50;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#xFF0C;&#x9000;&#x51FA;&#x4EE3;&#x7801;&#x4E3A;:&apos; + code);
});
p1.on(&apos;error&apos;, function (err) {
    console.log(&apos;&#x5B50;&#x8FDB;&#x7A0B;&#x5F00;&#x542F;&#x5931;&#x8D25;:&apos; + err);
    process.exit();
});
</code></pre>
<p>fork1.js</p>
<pre><code class="lang-javascript">process.argv.forEach(function (item) {
    process.stdout.write(item + &apos;\r\n&apos;);
});
</code></pre>
<p>fork2.js</p>
<pre><code class="lang-javascript">let fs = require(&apos;fs&apos;);
let out = fs.createWriteStream(path.join(__dirname, &apos;msg.txt&apos;));
process.on(&apos;message&apos;, function (data) {
    out.write(data);
});
</code></pre>
<h4 id="t262.2.3 &#x5B50;&#x8FDB;&#x7A0B;&#x4E0E;&#x7236;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;HTTP&#x670D;&#x52A1;&#x5668;">2.2.3 &#x5B50;&#x8FDB;&#x7A0B;&#x4E0E;&#x7236;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;HTTP&#x670D;&#x52A1;&#x5668; <a href="#t262.2.3 &#x5B50;&#x8FDB;&#x7A0B;&#x4E0E;&#x7236;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;HTTP&#x670D;&#x52A1;&#x5668;"> # </a></h4>
<pre><code class="lang-javascript">let http = require(&apos;http&apos;);
let {
    fork
} = require(&apos;child_process&apos;);
let fs = require(&apos;fs&apos;);
let net = require(&apos;net&apos;);
let path = require(&apos;path&apos;);
let child = fork(path.join(__dirname, &apos;8.child.js&apos;));
let server = net.createServer();
server.listen(8080, &apos;127.0.0.1&apos;, function () {
    child.send(&apos;server&apos;, server);
    console.log(&apos;&#x7236;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x670D;&#x52A1;&#x5668;&#x5DF2;&#x7ECF;&#x521B;&#x5EFA;&apos;);
    let httpServer = http.createServer();
    httpServer.on(&apos;request&apos;, function (req, res) {
        if (req.url != &apos;/favicon.ico&apos;) {
            let sum = 0;
            for (let i = 0; i &lt; 100000; i++) {
                sum += 1;
            }
            res.write(&apos;&#x5BA2;&#x6237;&#x7AEF;&#x8BF7;&#x6C42;&#x5728;&#x7236;&#x8FDB;&#x7A0B;&#x4E2D;&#x88AB;&#x5904;&#x7406;&#x3002;&apos;);
            res.end(&apos;sum=&apos; + sum);
        }
    });
    httpServer.listen(server);
});
</code></pre>
<pre><code class="lang-javascript">let http = require(&apos;http&apos;);
process.on(&apos;message&apos;, function (msg, server) {
    if (msg == &apos;server&apos;) {
        console.log(&apos;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x670D;&#x52A1;&#x5668;&#x5DF2;&#x7ECF;&#x88AB;&#x521B;&#x5EFA;&apos;);
        let httpServer = http.createServer();
        httpServer.on(&apos;request&apos;, function (req, res) {
            if (req.url != &apos;/favicon.ico&apos;) {
                sum = 0;
                for (let i = 0; i &lt; 10000; i++) {
                    sum += i;
                }
                res.write(&apos;&#x5BA2;&#x6237;&#x7AEF;&#x8BF7;&#x6C42;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x88AB;&#x5904;&#x7406;&apos;);
                res.end(&apos;sum=&apos; + sum);
            }
        });
        httpServer.listen(server);
    }
});
</code></pre>
<pre><code class="lang-javascript">let http = require(&apos;http&apos;);
let options = {
    hostname: &apos;localhost&apos;,
    port: 8080,
    path: &apos;/&apos;,
    method: &apos;GET&apos;
}
for (let i = 0; i &lt; 10; i++) {
    let req = http.request(options, function (res) {
        res.on(&apos;data&apos;, function (chunk) {
            console.log(&apos;&#x54CD;&#x5E94;&#x5185;&#x5BB9;:&apos; + chunk);
        });
    });
    req.end();
}
</code></pre>
<h4 id="t272.2.4 &#x5B50;&#x8FDB;&#x7A0B;&#x4E0E;&#x7236;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;socket&#x5BF9;&#x8C61;">2.2.4 &#x5B50;&#x8FDB;&#x7A0B;&#x4E0E;&#x7236;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;socket&#x5BF9;&#x8C61; <a href="#t272.2.4 &#x5B50;&#x8FDB;&#x7A0B;&#x4E0E;&#x7236;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;socket&#x5BF9;&#x8C61;"> # </a></h4>
<pre><code class="lang-javascript">let {
    fork
} = require(&apos;child_process&apos;);
let path = require(&apos;path&apos;);
let child = fork(path.join(__dirname, &apos;11.socket.js&apos;));
let server = require(&apos;net&apos;).createServer();
server.on(&apos;connection&apos;, function (socket) {
    if (Date.now() % 2 == 0) {
        child.send(&apos;socket&apos;, socket);
    } else {
        socket.end(&apos;&#x5BA2;&#x6237;&#x7AEF;&#x8BF7;&#x6C42;&#x88AB;&#x7236;&#x8FDB;&#x7A0B;&#x5904;&#x7406;!&apos;);
    }
});
server.listen(41234, );
</code></pre>
<pre><code class="lang-javascript">process.on(&apos;message&apos;, function (m, socket) {
    if (m === &apos;socket&apos;) {
        socket.end(&apos;&#x5BA2;&#x6237;&#x7AEF;&#x8BF7;&#x6C42;&#x88AB;&#x5B50;&#x8FDB;&#x7A0B;&#x5904;&#x7406;.&apos;);
    }
});
</code></pre>
<pre><code class="lang-javascript">let net = require(&apos;net&apos;);
let client = new net.Socket();
client.setEncoding(&apos;utf8&apos;);
client.connect(41234, &apos;localhost&apos;);
client.on(&apos;data&apos;, function (data) {
    console.log(data);
});
</code></pre>
<h3 id="t282.3 exec&#x5F00;&#x542F;&#x5B50;&#x8FDB;&#x7A0B;">2.3 exec&#x5F00;&#x542F;&#x5B50;&#x8FDB;&#x7A0B; <a href="#t282.3 exec&#x5F00;&#x542F;&#x5B50;&#x8FDB;&#x7A0B;"> # </a></h3>
<ul>
<li>exec&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x5F00;&#x542F;&#x4E00;&#x4E2A;&#x7528;&#x4E8E;&#x8FD0;&#x884C;&#x67D0;&#x4E2A;&#x547D;&#x4EE4;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x5E76;&#x7F13;&#x5B58;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8F93;&#x51FA;&#x7ED3;&#x679C;</li>
<li>spawn&#x662F;&#x4E00;&#x4E2A;&#x5F02;&#x6B65;&#x65B9;&#x6CD5;&#xFF0C;exec&#x662F;&#x4E00;&#x4E2A;&#x540C;&#x6B65;&#x65B9;&#x6CD5;</li>
<li>&#x884D;&#x751F;&#x4E00;&#x4E2A; shell &#x5E76;&#x5728; shell &#x4E0A;&#x8FD0;&#x884C;&#x547D;&#x4EE4;</li>
</ul>
<pre><code class="lang-javascript">child_process.exec(command,[options],[callback]);
</code></pre>
<ul>
<li>command &#x9700;&#x8981;&#x6267;&#x884C;&#x7684;&#x547D;&#x4EE4;</li>
<li>options &#x9009;&#x9879;&#x5BF9;&#x8C61;<ul>
<li>cwd &#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;</li>
<li>env &#x6307;&#x5B9A;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;</li>
<li>encoding &#x6307;&#x5B9A;&#x8F93;&#x51FA;&#x7684;&#x7F16;&#x7801;</li>
<li>timeout  &#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8D85;&#x65F6;&#x65F6;&#x95F4;</li>
<li>maxbuffer &#x6307;&#x5B9A;&#x7F13;&#x5B58;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x548C;&#x9519;&#x8BEF;&#x8F93;&#x51FA;&#x7684;&#x7F13;&#x5B58;&#x533A;&#x6700;&#x5927;&#x957F;&#x5EA6;</li>
<li>killSignal &#x6307;&#x5B9A;&#x5173;&#x95ED;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x4FE1;&#x53F7;&#xFF0C;&#x9ED8;&#x8BA4;&#x503C;&#x4E3A; &quot;SIGTERM&quot;</li>
</ul>
</li>
<li>callback &#x6307;&#x5B9A;&#x5B50;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#x8C03;&#x7528;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;<pre><code class="lang-javascript">function(err,stdout,stderr){}
</code></pre>
</li>
<li>err &#x9519;&#x8BEF;&#x5BF9;&#x8C61;</li>
<li>stdout &#x6807;&#x51C6;&#x8F93;&#x51FA;</li>
<li>stderr &#x9519;&#x8BEF;&#x8F93;&#x51FA;</li>
</ul>
<pre><code class="lang-javascript">let {
    exec
} = require(&apos;child_process&apos;);
let path = require(&apos;path&apos;);
let p1 = exec(&apos;node test1.js a b c&apos;, {
    cwd: path.join(__dirname, &apos;test3&apos;)
}, function (err, stdout, stderr) {
    if (err) {
        console.log(&apos;&#x5B50;&#x8FDB;&#x7A0B;&#x5F00;&#x542F;&#x5931;&#x8D25;:&apos; + err);
        process.exit();
    } else {
        console.log(&apos;&#x5B50;&#x8FDB;&#x7A0B;&#x6807;&#x51C6;&#x8F93;&#x51FA;\r\n&apos; + stdout.toString());
        p2.stdin.write(stdout.toString());
    }
});
let p2 = exec(&apos;node test2.js&apos;, {
    cwd: path.join(__dirname, &apos;test3&apos;)
}, function (err, stdout, stderr) {
    process.exit();
});
</code></pre>
<pre><code class="lang-javascript">let path = require(&apos;path&apos;);
process.argv.forEach(function (item) {
    process.stdout.write(item + &apos;\r\n&apos;);
});
</code></pre>
<pre><code class="lang-javascript">let fs = require(&apos;fs&apos;);
let path = require(&apos;path&apos;);
let out = fs.createWriteStream(path.join(__dirname, &apos;msg.txt&apos;));
process.stdin.on(&apos;data&apos;, function (data) {
    out.write(data);
    process.exit();
})
</code></pre>
<h3 id="t292.4 execFile&#x5F00;&#x542F;&#x5B50;&#x8FDB;&#x7A0B;">2.4 execFile&#x5F00;&#x542F;&#x5B50;&#x8FDB;&#x7A0B; <a href="#t292.4 execFile&#x5F00;&#x542F;&#x5B50;&#x8FDB;&#x7A0B;"> # </a></h3>
<ul>
<li>&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>execFile</code>&#x5F00;&#x542F;&#x4E00;&#x4E2A;&#x4E13;&#x95E8;&#x7528;&#x4E8E;&#x8FD0;&#x884C;&#x67D0;&#x4E2A;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;</li>
<li>&#x7C7B;&#x4F3C; child_process.exec()&#xFF0C;&#x4F46;&#x76F4;&#x63A5;&#x884D;&#x751F;&#x547D;&#x4EE4;&#xFF0C;&#x4E14;&#x65E0;&#x9700;&#x5148;&#x884D;&#x751F;&#x4E00;&#x4E2A; shell</li>
</ul>
<pre><code class="lang-javascript">child_process.execFile(file,[args],[optioins],[callback]);
</code></pre>
<ul>
<li>file &#x6307;&#x5B9A;&#x9700;&#x8981;&#x8FD0;&#x884C;&#x7684;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#x53CA;&#x6587;&#x4EF6;&#x540D;</li>
<li>args &#x8FD0;&#x884C;&#x8BE5;&#x6587;&#x4EF6;&#x6240;&#x9700;&#x8981;&#x7684;&#x53C2;&#x6570;</li>
<li>options &#x5F00;&#x542F;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x9009;&#x9879;</li>
<li>callback &#x6307;&#x5B9A;&#x5B50;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#x8C03;&#x7528;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;</li>
</ul>
<pre><code class="lang-javascript">let {
    execFile
} = require(&apos;child_process&apos;);
let path = require(&apos;path&apos;);

let p1 = execFile(&apos;node&apos;, [&apos;./test1.js&apos;], {
    cwd: path.join(__dirname, &apos;test4&apos;)
}, function (err, stdout, stderr) {
    if (err) {
        console.log(&apos;&#x5B50;&#x8FDB;&#x7A0B;1&#x5F00;&#x542F;&#x5931;&#x8D25;:&apos; + err);
        process.exit();
    } else {
        console.log(&apos;&#x5B50;&#x8FDB;&#x7A0B;&#x6807;&#x51C6;&#x8F93;&#x51FA;:&apos; + stdout.toString());
        p2.stdin.write(stdout.toString());
    }
});
let p2 = execFile(&apos;node&apos;, [&apos;./test2.js&apos;], {
    cwd: path.join(__dirname, &apos;test4&apos;)
}, function (err, stdout, stderr) {
    if (err) {
        console.log(&apos;&#x5B50;&#x8FDB;&#x7A0B;2&#x5F00;&#x542F;&#x5931;&#x8D25;:&apos; + err);
        process.exit();
    } else {
        console.log(&apos;&#x5B50;&#x8FDB;&#x7A0B;&#x6807;&#x51C6;&#x8F93;&#x51FA;:&apos; + stdout.toString());
    }
});
</code></pre>
<pre><code class="lang-javascript">#!/usr/bin/env node

let path = require(&apos;path&apos;);
process.argv.forEach(function (item) {
    process.stdout.write(item + &apos;\r\n&apos;);
});
</code></pre>
<pre><code class="lang-javascript">#!/usr/bin/env node

let fs = require(&apos;fs&apos;);
let path = require(&apos;path&apos;);
let out = fs.createWriteStream(path.join(__dirname, &apos;msg.txt&apos;));
process.stdin.on(&apos;data&apos;, function (data) {
    out.write(data);
    process.exit();
})
</code></pre>
<h2 id="t303. cluster">3. cluster <a href="#t303. cluster"> # </a></h2>
<p>&#x4E3A;&#x4E86;&#x5229;&#x7528;&#x591A;&#x6838;CPU&#x7684;&#x4F18;&#x52BF;&#xFF0C;Node.js&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;cluster&#x6A21;&#x5757;&#x5141;&#x8BB8;&#x5728;&#x591A;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x8FD0;&#x884C;&#x4E0D;&#x540C;&#x7684;Node.js&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x3002;</p>
<h3 id="t313.1 fork&#x65B9;&#x6CD5;&#x521B;&#x5EFA;work&#x5BF9;&#x8C61;">3.1 fork&#x65B9;&#x6CD5;&#x521B;&#x5EFA;work&#x5BF9;&#x8C61; <a href="#t313.1 fork&#x65B9;&#x6CD5;&#x521B;&#x5EFA;work&#x5BF9;&#x8C61;"> # </a></h3>
<ul>
<li>&#x53EF;&#x4EE5;&#x4F7F;&#x7528;fork&#x65B9;&#x6CD5;&#x5F00;&#x542F;&#x591A;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x5728;&#x6BCF;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;Node.js&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x5B9E;&#x4F8B;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x8BE5;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x8FD0;&#x884C;&#x4E00;&#x4E2A;&#x6A21;&#x5757;&#x6587;&#x4EF6;&#x3002;</li>
<li>fork&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x9690;&#x5F0F;&#x521B;&#x5EFA;&#x7684;work&#x5BF9;&#x8C61;</li>
<li>&#x5728;cluster&#x6A21;&#x5757;&#x4E2D;&#xFF0C;&#x5206;&#x522B;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;isMaster&#x5C5E;&#x6027;&#x4E0E;&#x4E00;&#x4E2A;isWork&#x5C5E;&#x6027;&#xFF0C;&#x90FD;&#x662F;&#x5E03;&#x5C14;&#x503C;<pre><code class="lang-javascript">cluster.fork([env]);
</code></pre>
</li>
<li>env &#x4E3A;&#x5B50;&#x8FDB;&#x7A0B;&#x6307;&#x5B9A;&#x73AF;&#x5883;&#x53D8;&#x91CF;</li>
</ul>
<h4 id="t323.1.1 &#x83B7;&#x53D6;&#x6240;&#x6709;&#x7684;worker">3.1.1 &#x83B7;&#x53D6;&#x6240;&#x6709;&#x7684;worker <a href="#t323.1.1 &#x83B7;&#x53D6;&#x6240;&#x6709;&#x7684;worker"> # </a></h4>
<pre><code class="lang-javascript">for(let index in cluster.workers){
    console.log(cluster.workers[index]);
}
</code></pre>
<h4 id="t333.1.2 &#x83B7;&#x53D6;&#x5F53;&#x524D;&#x7684;worker&#x548C;id">3.1.2 &#x83B7;&#x53D6;&#x5F53;&#x524D;&#x7684;worker&#x548C;id <a href="#t333.1.2 &#x83B7;&#x53D6;&#x5F53;&#x524D;&#x7684;worker&#x548C;id"> # </a></h4>
<pre><code class="lang-javascript">if(cluster.isMaster){
  cluster.fork()
}else if(cluster.isWorker){
  console.log(&apos;I am worker #&apos;+cluster.worker.id);
}
</code></pre>
<h4 id="t343.1.3 &#x670D;&#x52A1;&#x5668;">3.1.3 &#x670D;&#x52A1;&#x5668; <a href="#t343.1.3 &#x670D;&#x52A1;&#x5668;"> # </a></h4>
<pre><code class="lang-javascript">let cluster = require(&apos;cluster&apos;);
let http = require(&apos;http&apos;);
if (cluster.isMaster) {
    cluster.fork();
    console.log(&apos;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x8FD0;&#x884C;&#x5728;&#x4E3B;&#x8FDB;&#x7A0B;&#x91CC;&apos;);
} else {
    http.createServer(function (req, res) {
        if (req.url != &apos;/favicon.ico&apos;) {
            res.end(&apos;hello&apos;);
            console.log(&apos;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x8FD0;&#x884C;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x91CC;&apos;);
        }
    }).listen(8080);
}
</code></pre>
<h4 id="t353.1.4 fork&#x4E8B;&#x4EF6;">3.1.4 fork&#x4E8B;&#x4EF6; <a href="#t353.1.4 fork&#x4E8B;&#x4EF6;"> # </a></h4>
<p>&#x5F53;&#x4F7F;&#x7528;fork&#x65B9;&#x6CD5;&#x5F00;&#x542F;&#x5B50;&#x8FDB;&#x7A0B;&#x65F6;&#xFF0C;&#x5C06;&#x540C;&#x65F6;&#x89E6;&#x53D1;fork&#x4E8B;&#x4EF6;</p>
<pre><code class="lang-javascript">cluster.on(&apos;fork&apos;,function(worker){
  console.log(&apos;&#x5B50;&#x8FDB;&#x7A0B; &apos;+workder.id+&apos;&#x88AB;&#x5F00;&#x542F;&apos;);  
});
</code></pre>
<h4 id="t363.1.5 online&#x4E8B;&#x4EF6;">3.1.5 online&#x4E8B;&#x4EF6; <a href="#t363.1.5 online&#x4E8B;&#x4EF6;"> # </a></h4>
<ul>
<li>&#x5728;&#x4F7F;&#x7528;fork&#x65B9;&#x6CD5;&#x5F00;&#x542F;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x7528;&#x4E8E;&#x8FD0;&#x884C;Node.js&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x540E;&#xFF0C;&#x8BE5;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5C06;&#x901A;&#x8FC7;&#x5411;&#x4E3B;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x53CD;&#x9988;&#x4FE1;&#x606F;&#xFF0C;&#x5F53;&#x4E3B;&#x8FDB;&#x7A0B;&#x63A5;&#x6536;&#x5230;&#x8BE5;&#x53CD;&#x9988;&#x4FE1;&#x606F;&#x540E;&#xFF0C;&#x89E6;&#x53D1;online&#x4E8B;&#x4EF6;</li>
</ul>
<pre><code class="lang-javascript">cluster.on(&apos;online&apos;,function(worker){
  console.log(&apos;&#x5DF2;&#x7ECF;&#x6536;&#x5230;&#x5B50;&#x8FDB;&#x7A0B;#&apos;+workder.id+&quot;&#x7684;&#x6D88;&#x606F;&quot;);
});
</code></pre>
<h4 id="t373.1.6 listening">3.1.6 listening <a href="#t373.1.6 listening"> # </a></h4>
<p>&#x5F53;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x8FD0;&#x884C;&#x7684;Node.js&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x8C03;&#x7528;&#x670D;&#x52A1;&#x5668;&#x7684;listen&#x65B9;&#x6CD5;&#x540E;&#xFF0C;&#x8BE5;&#x670D;&#x52A1;&#x5668;&#x5F00;&#x59CB;&#x5BF9;&#x6307;&#x5B9A;&#x5730;&#x5740;&#x53CA;&#x7AEF;&#x53E3;&#x8FDB;&#x884C;&#x76D1;&#x542C;&#xFF0C;&#x540C;&#x65F6;&#x89E6;&#x53D1;listening&#x4E8B;&#x4EF6;&#x3002;</p>
<pre><code class="lang-javascript">let cluster = require(&apos;cluster&apos;);
let http = require(&apos;http&apos;);
if (cluster.isMaster) {
    cluster.fork();
    console.log(&apos;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x8FD0;&#x884C;&#x5728;&#x4E3B;&#x8FDB;&#x7A0B;&#x91CC;&apos;);
} else {
    http.createServer(function (req, res) {
        if (req.url != &apos;/favicon.ico&apos;) {
            res.end(&apos;hello&apos;);
            console.log(&apos;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x8FD0;&#x884C;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x91CC;&apos;);
        }
    }).listen(8080, &apos;localhost&apos;);
}
cluster.on(&apos;online&apos;, function (worker) {
    console.log(&apos;&#x5DF2;&#x7ECF;&#x6536;&#x5230;&#x5B50;&#x8FDB;&#x7A0B;#&apos; + worker.id + &quot;&#x7684;&#x6D88;&#x606F;&quot;);
});
cluster.on(&apos;listening&apos;, function (worker, address) {
    console.log(&apos;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x670D;&#x52A1;&#x5668;&#x5F00;&#x59CB;&#x76D1;&#x542C;,&#x5730;&#x5740;&#x4E3A;:&apos; + address.address + &quot;:&quot; + address.port);
});
</code></pre>
<h4 id="t383.1.7 setupMaster">3.1.7 setupMaster <a href="#t383.1.7 setupMaster"> # </a></h4>
<p>&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;Node.js&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9ED8;&#x8BA4;&#x8FD0;&#x884C;&#x5F53;&#x524D;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x7684;Node.js&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;&#x4E3B;&#x6A21;&#x5757;&#x6587;&#x4EF6;&#x3002;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;setupMaster&#x65B9;&#x6CD5;&#x4FEE;&#x6539;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x8FD0;&#x884C;&#x7684;&#x6A21;&#x5757;&#x6587;&#x4EF6;</p>
<pre><code class="lang-javascript">cluster.setupMaster([settings]);
</code></pre>
<ul>
<li>settings&#x8BBE;&#x7F6E;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x8FD0;&#x884C;&#x7684;Node.js&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5404;&#x79CD;&#x9ED8;&#x8BA4;&#x884C;&#x4E3A;&#x7684;&#x5BF9;&#x8C61;<ul>
<li>exec &#x5B50;&#x8FDB;&#x7A0B;&#x8FD0;&#x884C;&#x7684;&#x6A21;&#x5757;&#x6587;&#x4EF6;&#x540D;&#x79F0;&#x7684;&#x5B8C;&#x6574;&#x8DEF;&#x5F84;&#x53CA;&#x6587;&#x4EF6;&#x540D;</li>
<li>args &#x5C5E;&#x6027;&#x4E3A;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#xFF0C;&#x5176;&#x4E2D;&#x5B58;&#x653E;&#x4E86;&#x6240;&#x6709;&#x8FD0;&#x884C;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;Node.js&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;&#x6240;&#x9700;&#x8981;&#x7684;&#x53C2;&#x6570;</li>
<li>silent &#x5E03;&#x5C14;&#x503C;&#x3002;&#x5F53;&#x5C5E;&#x6027;&#x503C;&#x4E3A;false&#x65F6;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x5BF9;&#x8C61;&#x4E0E;&#x4E3B;&#x8FDB;&#x7A0B;&#x5BF9;&#x8C61;&#x5171;&#x4EAB;&#x6807;&#x51C6;&#x8F93;&#x5165;/&#x8F93;&#x51FA;</li>
</ul>
</li>
</ul>
<pre><code class="lang-javascript">let cluster = require(&apos;cluster&apos;);
cluster.setupMaster({
    exec: &apos;subtask.js&apos;
});
cluster.fork();
console.log(&apos;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x88AB;&#x8FD0;&#x884C;&#x5B50;&#x4E3B;&#x8FDB;&#x7A0B;&#x4E2D;&apos;);
console.log(&apos;cluster.settings&#x5C5E;&#x6027;&#x503C;: %j&apos;, cluster.settings);
</code></pre>
<pre><code class="lang-javascript">let http = require(&apos;http&apos;);
http.createServer(function (req, res) {
    if (req.url != &apos;/favicon.ico&apos;) {
        res.writeHead(200);
        res.end(&apos;ok&apos;);
        console.log(&apos;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x88AB;&#x8FD0;&#x884C;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&apos;);
    }
}).listen(8080);
</code></pre>
<h4 id="t393.1.8 &#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x91CC;&#x8FD0;&#x884C;&#x670D;&#x52A1;&#x5668;">3.1.8 &#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x91CC;&#x8FD0;&#x884C;&#x670D;&#x52A1;&#x5668; <a href="#t393.1.8 &#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x91CC;&#x8FD0;&#x884C;&#x670D;&#x52A1;&#x5668;"> # </a></h4>
<p>&#x5F53;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x91CC;&#x8FD0;&#x884C;&#x670D;&#x52A1;&#x5668;&#x65F6;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x603B;&#x662F;&#x5148;&#x88AB;&#x4E3B;&#x8FDB;&#x7A0B;&#x63A5;&#x6536;&#xFF0C;&#x7136;&#x540E;&#x8F6C;&#x53D1;&#x7ED9;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x670D;&#x52A1;&#x5668;&#x3002;&#x5982;&#x679C;&#x5728;&#x591A;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x8FD0;&#x884C;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x5F53;&#x4E3B;&#x8FDB;&#x7A0B;&#x63A5;&#x6536;&#x5230;&#x5BA2;&#x6237;&#x7AEF;&#x8BF7;&#x6C42;&#x540E;&#xFF0C;&#x5C06;&#x4F1A;&#x81EA;&#x52A8;&#x5206;&#x914D;&#x7ED9;&#x4E00;&#x4E2A;&#x5F53;&#x524D;&#x5904;&#x4E8E;&#x7A7A;&#x95F2;&#x72B6;&#x6001;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;</p>
<pre><code class="lang-javascript">let cluster = require(&apos;cluster&apos;);
let http = require(&apos;http&apos;);
if (cluster.isMaster) {
    cluster.fork();
    cluster.fork();
} else {
    http.createServer(function (req, res) {
        if (req.url !== &apos;/favicon.ico&apos;) {
            let sum = 0;
            for (let i = 0; i &lt; 1000000; i++) {
                sum += i;
            }
            res.writeHead(200);
            res.write(`&#x5BA2;&#x6237;&#x7AEF;&#x8BF7;&#x6C42;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;${cluster.worker.id}&#x4E2D;&#x88AB;&#x5904;&#x7406;`);
            res.end(`&#x5B50;&#x8FDB;&#x7A0B;${cluster.worker.id}&#x4E2D;&#x7684;&#x8BA1;&#x7B97;&#x7ED3;&#x679C;=${sum}`);
        }
    }).listen(8080);
}
</code></pre>
<h4 id="t403.1.9 &#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x4F7F;&#x7528;&#x5355;&#x72EC;&#x7684;&#x8F93;&#x51FA;">3.1.9 &#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x4F7F;&#x7528;&#x5355;&#x72EC;&#x7684;&#x8F93;&#x51FA; <a href="#t403.1.9 &#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x4F7F;&#x7528;&#x5355;&#x72EC;&#x7684;&#x8F93;&#x51FA;"> # </a></h4>
<pre><code class="lang-javascript">let cluster = require(&apos;cluster&apos;);
let http = require(&apos;http&apos;);
if (cluster.isMaster) {
    cluster.setupMaster({
        silent: true
    });
    let worker = cluster.fork();
    worker.process.stdout.on(&apos;data&apos;, function (data) {
        console.log(&apos;&#x63A5;&#x6536;&#x5230;&#x6765;&#x81EA;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x8BF7;&#x6C42;&#xFF0C;&#x76EE;&#x6807;&#x5730;&#x5740;:&apos; + data);
    });
} else {
    http.createServer(function (req, res) {
        if (req.url !== &apos;/favicon.ico&apos;) {
            let sum = 0;
            for (let i = 0; i &lt; 1000000; i++) {
                sum += i;
            }
            res.writeHead(200);
            console.log(`&#x5BA2;&#x6237;&#x7AEF;&#x8BF7;&#x6C42;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;${cluster.worker.id}&#x4E2D;&#x88AB;&#x5904;&#x7406;`);
            res.write(`&#x5BA2;&#x6237;&#x7AEF;&#x8BF7;&#x6C42;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;${cluster.worker.id}&#x4E2D;&#x88AB;&#x5904;&#x7406;`);
            res.end(`&#x5B50;&#x8FDB;&#x7A0B;${cluster.worker.id}&#x4E2D;&#x7684;&#x8BA1;&#x7B97;&#x7ED3;&#x679C;=${sum}`);
        }
    }).listen(8080);
}
</code></pre>
<h3 id="t413.2 worker&#x5BF9;&#x8C61;">3.2 worker&#x5BF9;&#x8C61; <a href="#t413.2 worker&#x5BF9;&#x8C61;"> # </a></h3>
<h4 id="t423.2.1 online">3.2.1 online <a href="#t423.2.1 online"> # </a></h4>
<p>&#x5F53;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x5DE5;&#x4F5C;&#x8FDB;&#x7A0B;&#x540E;&#xFF0C;&#x5DE5;&#x4F5C;&#x8FDB;&#x7A0B;&#x5E94;&#x5F53;&#x54CD;&#x5E94;&#x4E00;&#x4E2A;online&#x6D88;&#x606F;&#x7ED9;&#x4E3B;&#x8FDB;&#x7A0B;&#x3002;&#x5F53;&#x4E3B;&#x8FDB;&#x7A0B;&#x6536;&#x5230;online&#x6D88;&#x606F;&#x540E;&#x89E6;&#x53D1;&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;</p>
<pre><code class="lang-javascript">let cluster = require(&apos;cluster&apos;);
let http = require(&apos;http&apos;);
if (cluster.isMaster) {
    let worker = cluster.fork();
    console.log(&apos;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x88AB;&#x8FD0;&#x884C;&#x5728;&#x4E3B;&#x8FDB;&#x7A0B;&#x91CC;&apos;);
    worker.on(&apos;online&apos;, function () {
        console.log(`&#x5DF2;&#x7ECF;&#x6536;&#x5230;&#x5B50;&#x8FDB;&#x7A0B;${worker.id}&#x7684;&#x8FD0;&#x884C;&#x4FE1;&#x606F;`);
    });
} else {
    http.createServer(function (req, res) {
        if (req.url !== &apos;/favicon.ico&apos;) {
            let sum = 0;
            for (let i = 0; i &lt; 1000000; i++) {
                sum += i;
            }
            res.end(&apos;ok&apos;);
            console.log(`&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x88AB;&#x8FD0;&#x884C;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x3002;`);
        }
    }).listen(8080);
}
</code></pre>
<h4 id="t433.2.2 send">3.2.2 send <a href="#t433.2.2 send"> # </a></h4>
<p>&#x5728;&#x4F7F;&#x7528;fork&#x53D1;&#x653E;&#x5F00;&#x542F;&#x5B50;&#x8FDB;&#x7A0B;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;fork&#x65B9;&#x6CD5;&#x6240;&#x8FD4;&#x56DE;&#x7684;worker&#x5BF9;&#x8C61;&#x7684;send&#x65B9;&#x6CD5;&#x5728;&#x4E3B;&#x8FDB;&#x7A0B;&#x4E2D;&#x5411;&#x5B50;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x6D88;&#x606F;&#x3002;</p>
<pre><code class="lang-javascript">worker.send(message,[sendHandle]);//&#x5728;&#x4E3B;&#x8FDB;&#x7A0B;&#x4E2D;&#x5411;&#x5B50;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x6D88;&#x606F;
process.send(message,[sendHandle]);//&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x50CF;&#x4E3B;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x6D88;&#x606F;
process.on(&apos;message&apos;,function(m,setHandle){});
</code></pre>
<pre><code class="lang-javascript">let cluster = require(&apos;cluster&apos;);
cluster.setupMaster({
    exec: &apos;child.js&apos;
});
let worker = cluster.fork();
worker.on(&apos;message&apos;, function (m) {
    console.log(&apos;&#x7236;&#x8FDB;&#x7A0B;&#x63A5;&#x6536;&#x5230;&#x6D88;&#x606F;:&apos;, m);
    process.exit();
});
worker.send({
    name: &apos;zfpx&apos;
});
</code></pre>
<h4 id="t443.2.3 &#x5171;&#x4EAB;socket">3.2.3 &#x5171;&#x4EAB;socket <a href="#t443.2.3 &#x5171;&#x4EAB;socket"> # </a></h4>
<pre><code class="lang-javascript">let http = require(&apos;http&apos;);
let cluster = require(&apos;cluster&apos;);
let net = require(&apos;net&apos;);
cluster.setupMaster({
    exec: &apos;22.subsocket.js&apos;
});
let worker = cluster.fork();
let server = require(&apos;net&apos;).createServer();
server.on(&apos;connection&apos;, function (socket) {
    if (Date.now() % 2 == 0) {
        worker.send(&apos;socket&apos;, socket);
    } else {
        socket.end(&apos;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x8BF7;&#x6C42;&#x5728;&#x4E3B;&#x8FDB;&#x7A0B;&#x4E2D;&#x5904;&#x7406;&apos;);
    }

});
server.listen(41234, &apos;localhost&apos;);
worker.on(&apos;message&apos;, function (m, socket) {
    console.log(m);

});
</code></pre>
<pre><code class="lang-javascript">process.on(&apos;message&apos;, function (msg, socket) {
    if (msg == &apos;socket&apos;) {
        socket.end(&apos;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x8FD4;&#x56DE;&#x6D88;&#x606F;:&apos; + msg);
        process.send(&apos;&#x544A;&#x8BC9;&#x7236;&#x8FDB;&#x7A0B;&#x6211;&#x5904;&#x7406;&#x4E86;&#x4E00;&#x4E2A;&#x6D88;&#x606F;&apos;);
    }
});
</code></pre>
<h4 id="t453.2.4 kill">3.2.4 kill <a href="#t453.2.4 kill"> # </a></h4>
<p>&#x5F53;&#x4F7F;&#x7528;fork&#x65B9;&#x6CD5;&#x5F00;&#x542F;&#x5B50;&#x8FDB;&#x7A0B;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;fork&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x7684;worker&#x5BF9;&#x8C61;&#x7684;kill&#x65B9;&#x6CD5;&#x5F3A;&#x5236;&#x5173;&#x95ED;&#x5B50;&#x8FDB;&#x7A0B;</p>
<pre><code class="lang-javascript">worker.kill([signal]);
</code></pre>
<ul>
<li>signal &#x5F3A;&#x5236;&#x5173;&#x95ED;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x4FE1;&#x53F7;&#x5B57;&#x7B26;&#x4E32;&#x3002;&#x9ED8;&#x8BA4;&#x53C2;&#x6570;&#x503C;&#x4E3A; &quot;SIGTERM&quot;</li>
</ul>
<h4 id="t463.2.5 exit">3.2.5 exit <a href="#t463.2.5 exit"> # </a></h4>
<p>&#x5F53;&#x5B50;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x65F6;&#xFF0C;&#x5C06;&#x4F1A;&#x89E6;&#x53D1;worker&#x5BF9;&#x8C61;&#x7684;exit&#x4E8B;&#x4EF6;</p>
<pre><code>worker.on(&apos;exit&apos;,function(code,signal));
</code></pre><ul>
<li>code &#x9000;&#x51FA;&#x4EE3;&#x7801;&#x3002;&#x6B63;&#x5E38;&#x9000;&#x51FA;&#x4E3A;0&#xFF0C;&#x5F02;&#x5E38;&#x9000;&#x51FA;&#x4E3A;null</li>
<li>worker.exitedAfterDisconnect&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x533A;&#x5206;&#x81EA;&#x53D1;&#x9000;&#x51FA;&#x8FD8;&#x662F;&#x88AB;&#x52A8;&#x9000;&#x51FA;&#xFF0C;&#x4E3B;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x8FD9;&#x4E2A;&#x503C;&#x51B3;&#x5B9A;&#x662F;&#x5426;&#x91CD;&#x65B0;&#x884D;&#x751F;&#x65B0;&#x7684;&#x5DE5;&#x4F5C;&#x8FDB;&#x7A0B;&#x3002;</li>
</ul>
<pre><code class="lang-javascript">let cluster = require(&apos;cluster&apos;);
let http = require(&apos;http&apos;);
if (cluster.isMaster) {
    cluster.setupMaster({
        silent: true
    });
    let worker = cluster.fork();
    worker.process.stdout.on(&apos;data&apos;, function (data) {
        console.log(&apos;&#x63A5;&#x6536;&#x5230;&#x6765;&#x81EA;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x8BF7;&#x6C42;,&#x76EE;&#x6807;&#x5730;&#x5740;&#x4E3A;:&apos; + data);
        worker.kill(); //&#x8BA9;&#x5B50;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;
    });
    worker.on(&apos;exit&apos;, function (code, signal) {
        console.log(arguments)
        //suicide&#x53EF;&#x4EE5;&#x5224;&#x65AD;&#x662F;&#x81EA;&#x52A8;&#x9000;&#x51FA;&#x8FD8;&#x662F;&#x5F02;&#x5E38;&#x9000;&#x51FA;&#xFF0C;&#x9000;&#x51FA;&#x4E4B;&#x524D;&#x65F6;undefined.&#x81EA;&#x52A8;&#x9000;&#x51FA;&#x4E3A;true,&#x5F02;&#x5E38;&#x9000;&#x51FA;&#x4E3A;false
        if (worker.exitedAfterDisconnect  == true) {
            console.log(`&#x5B50;&#x8FDB;&#x7A0B;%{worker.id}&#x81EA;&#x52A8;&#x9000;&#x51FA;`);
        } else if (worker.exitedAfterDisconnect  == false) {
            console.log(`&#x5B50;&#x8FDB;&#x7A0B;${worker.id}&#x5F02;&#x5E38;&#x9000;&#x51FA;&#xFF0C;&#x9000;&#x51FA;&#x4EE3;&#x7801;&#x4E3A;${code}`);
        }
        if (signal) {
            console.log(&apos;&#x9000;&#x51FA;&#x4FE1;&#x53F7;&#x4E3A; %s&apos;, signal);
        }
    });
} else {
    let server = http.createServer(function (req, res) {
        if (req.url != &apos;/favicon.ico&apos;) {
            res.end(&apos;hello&apos;);
            process.stdout.write(req.url);
        }
    }).listen(8080);
}
</code></pre>
<h4 id="t473.2.6 disconnect">3.2.6 disconnect <a href="#t473.2.6 disconnect"> # </a></h4>
<p>&#x53EF;&#x4EE5;&#x4F7F;&#x7528;worker&#x5BF9;&#x8C61;&#x7684;disconnect&#x65B9;&#x6CD5;&#x4F7F;&#x8BE5;&#x5B50;&#x8FDB;&#x7A0B;&#x4E0D;&#x518D;&#x63A5;&#x6536;&#x5916;&#x90E8;&#x8FDE;&#x63A5;</p>
<pre><code class="lang-javascript">let cluster = require(&apos;cluster&apos;);
let http = require(&apos;http&apos;);
if (cluster.isMaster) {
    cluster.setupMaster({ silent: true });
    let worker = cluster.fork();
    worker.process.stdout.on(&apos;data&apos;, function (data) {
        console.log(&apos;&#x63A5;&#x6536;&#x5230;&#x6765;&#x81EA;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x8BF7;&#x6C42;,&#x76EE;&#x6807;&#x5730;&#x5740;&#x4E3A;:&apos; + data);
        setTimeout(function () {
            worker.disconnect();//&#x4E0D;&#x518D;&#x63A5;&#x6536;&#x8FDE;&#x63A5;
            worker.send(&apos;disconnect&apos;);
        }, 2000);
    });

    worker.on(&apos;disconnect&apos;, function () {
        console.log(`&#x5B50;&#x8FDB;&#x7A0B;${worker.id}&#x65AD;&#x5F00;&#x8FDE;&#x63A5;`);
    });
    worker.on(&apos;exit&apos;, function (code, signal) {
        if (worker.exitedAfterDisconnect) {
            console.log(`&#x5B50;&#x8FDB;&#x7A0B;${worker.id}&#x6B63;&#x5E38;&#x9000;&#x51FA;`);
        } else {
            console.log(`&#x5B50;&#x8FDB;&#x7A0B;${worker.id}&#x5F02;&#x5E38;&#x9000;&#x51FA;`);
        }
        if (signal) {
            console.log(&apos; &#x9000;&#x51FA;&#x4FE1;&#x53F7;&#x4E3A;&apos; + signal);
        }
    });

} else {
    let http = require(&apos;http&apos;);
    let server = http.createServer(function (req, res) {
        if (req.url != &apos;/favicon.ico&apos;) {
            res.end(&apos;hello&apos;);
            process.stdout.write(req.url);
        }
    }).listen(8080);
    process.on(&apos;message&apos;, function (msg) {
        if (msg == &apos;disconnect&apos;) {
            //process.exit(0);
        }

    });
}

</code></pre>

        <div class="copyright">Powered by <a href="https://github.com/jaywcjlove/idoc" target="_blank">idoc</a>. Dependence <a href="https://nodejs.org">Node.js</a> run.</div>
    